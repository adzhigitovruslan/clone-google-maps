const input=document.querySelector("#search_field"),submitButton=document.querySelector("#submit");let map,infoWindow,myLatLng,marker,requestURL="https://ipgeolocation.abstractapi.com/v1/?api_key=c5094700a1614fa08030c502c0fdf9f2";function initMap(e){map=new google.maps.Map(document.getElementById("map"),{center:e,zoom:15,streetViewControl:!1,fullscreenControl:!1,mapTypeControl:!1}),marker=new google.maps.Marker({position:e,map:map,icon:{url:"img/location_icon.svg",scaledSize:new google.maps.Size(32,40)}}),infoWindow=new google.maps.InfoWindow}function handleLocationError(e,t,o){t.setPosition(o),t.setContent(e?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation."),t.open(map)}function showData(e){document.querySelector("#isp_get").textContent=e.connection.isp_name,e.timezone.gmt_offset>0?document.querySelector("#timezone_get").textContent="UTC+0"+e.timezone.gmt_offset+":00":e.timezone.gmt_offset<0&&(document.querySelector("#timezone_get").textContent="UTC"+e.timezone.gmt_offset+":00"),document.querySelector("#location_get").textContent=e.city,document.querySelector("#ip_get").textContent=e.ip_address}function sendRequest(e,t){return fetch(t).then((e=>e.json()))}navigator.geolocation?navigator.geolocation.getCurrentPosition((e=>{const t={lat:e.coords.latitude,lng:e.coords.longitude};map.setCenter(t),marker=new google.maps.Marker({position:t,map:map,icon:{url:"img/location_icon.svg",scaledSize:new google.maps.Size(32,40)}})}),(()=>{handleLocationError(!0,infoWindow,map.getCenter())})):handleLocationError(!1,infoWindow,map.getCenter()),submitButton.addEventListener("click",(function(){input.value&&(requestURL="https://ipgeolocation.abstractapi.com/v1/?api_key=c5094700a1614fa08030c502c0fdf9f2&ip_address="+input.value,sendRequest("GET",requestURL).then((e=>{myLatLng={lat:e.latitude,lng:e.longitude},initMap(myLatLng),showData(e)})).catch((e=>customAlert())),input.value="")})),input.addEventListener("keyup",(function(e){e.preventDefault(),13===e.keyCode&&submitButton.click()})),sendRequest("GET",requestURL).then((e=>{showData(e)})).catch((e=>console.log(e)));const alert=document.querySelector("#alert");function customAlert(){alert.classList.remove("hide"),alert.classList.add("show"),alert.classList.add("showAlert"),setTimeout((()=>{alert.classList.add("hide"),alert.classList.remove("show")}),5e3)}const closeButton=document.querySelector(".close-btn");closeButton.addEventListener("click",(()=>{alert.classList.add("hide"),alert.classList.remove("show")}));